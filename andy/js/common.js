$(document).ready(function(){function n(){var n='https://mongo-data-api-chinesechess.herokuapp.com/api/1/databases/chinesechess2016/collections/user?q={useraccount:"'+$(".login_page .signaccount").val()+'"}&apiKey='+t.mlabApikey;r(!0),$.ajax({url:n,type:"GET",contentType:"application/json",success:function(n){t.issignup=n,o()},error:function(n,o,i){console.log("error:",n,o,i)}})}function o(){if(""==t.issignup){if(!($(".login_page_sign .signname").val()&&$(".login_page_sign .signpassword").val()&&$(".login_page_sign .signaccount").val()&&$(".login_page_sign .signemail").val()))return alert(t.creatUsererrortxt),void r(!1);$.ajax({url:"https://mongo-data-api-chinesechess.herokuapp.com/api/1/databases/chinesechess2016/collections/user?apiKey="+t.mlabApikey,type:"POST",contentType:"application/json",data:JSON.stringify({username:$(".login_page_sign .signname").val(),userpassword:$(".login_page_sign .signpassword").val(),useraccount:$(".login_page_sign .signaccount").val(),useremail:$(".login_page_sign .signemail").val()}),success:function(n){r(!1),$(".msg").fadeIn(),setTimeout(function(){$(".msg").fadeOut()},5e3),c(),i(!1)},error:function(n,o,i){console.log("error:",n,o,i)}})}else r(!1),alert(t.signerrortxt)}function i(n){n?$(".login_pagein").addClass("on"):$(".login_pagein").removeClass("on")}function e(n,o){var i='https://mongo-data-api-chinesechess.herokuapp.com/api/1/databases/chinesechess2016/collections/user?q={useraccount:"'+n+'",userpassword:"'+o+'"}&apiKey='+t.mlabApikey;r(!0),$.ajax({url:i,type:"GET",contentType:"application/json",success:function(n){t.islogin=n,c(),a()},error:function(n,o,i){console.log("error:",n,o,i)}})}function a(){""!=t.islogin?($.cookie("useraccount",t.islogin[0].useraccount),$.cookie("userpassword",t.islogin[0].userpassword),$.cookie("username",t.islogin[0].username),window.location.href="main.html"+window.location.hash):(r(!1),alert(t.loginerrortxt))}function s(){var n=!1;return $.cookie("useraccount")&&$.cookie("userpassword")&&(n=!0),n}function c(){$(".login_page_sign .signname").val(""),$(".login_page_sign .signpassword").val(""),$(".login_page_sign .signaccount").val(""),$(".login_page_sign .signemail").val(""),$(".login_pagein").find("input").val("")}function r(n){n?$(".loading").fadeIn():($(".loading").hasClass("on")||$(".loading").addClass("on"),$(".loading").fadeOut())}var t={};t.mlabApikey="n6FXodWWCdM14KrePZHrRPPovbzboRn6",t.loginerrortxt="帳號或密碼錯誤，請重新輸入",t.signerrortxt="此帳號有人註冊過，請換一個帳號",t.creatUsererrortxt="請填寫完整資料",$(".login_pagein .submitbtn").click(function(){n()}),$(".login_pagein .cancelbtn").click(function(){i(!1)}),$(".login_pagein .singupbtn").click(function(){i(!0)}),$(".login_pagein .surebtn").click(function(){e($(".login_page .useraccount").val(),$(".login_page .userpassword").val())}),$(window).load(function(){s()?e($.cookie("useraccount"),$.cookie("userpassword")):r(!1)})});